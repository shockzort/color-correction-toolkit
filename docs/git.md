# Git branching model для Видео Облака

Придерживаемся модели [trunk based development](https://trunkbaseddevelopment.com/).

## Основные идеи

1. master -- ветка, в которую попадает самый актуальный код.
2. Для фичей (история, задача, багфикс) заводятся _фичаветки_ относительно мастера. Фичаветка получает имя вида `XXXX-feature-{name-of-the-branch}`, где `XXXX` -- идентификатор задачи в таск-трекере (например, AR-777), а `name-of-the-branch` -- имя ветки.
3. По завершению фичи, фичаветка ребейзится на мастер и вливается с `--no-ff`. Сообщение коммита при влитии должно иметь вид `[master] XXXX Описание фичи`.
4. Для задачи в рамках фичи, относительно фичеветки заводится _рабочая ветка_, которая полчает имя вида `XXXX-{name-of-the-task-branch}`.
5. Рабочая ветка завершенной задачи ребейзается на фичеветку и вливается в нее со `--squash`. Сообщение коммита должно иметь вид `[XXXX] Описание задачи.` НЕ допускается оставлять сообщения схлопнутых коммитов, т.к. смысловой нагрузки после влития в фичаветку они не несут.
6. Релиз производится, как правило, из мастера.

## Структура коммитов

### Названия коммитов релиза

Коммиты релиза должны следовать следующим шаблонам:

**Правило**: Коммиты релиза должны иметь префикс `[release-YYYY.MM.DD.i]` с кратким описанием изменений, где `YYYY.MM.DD` - дата релиза, `i` - патч-версия.

- **Коммиты релиза с префиксом `[release-YYYY.MM.DD.i]`**:
  - `[release-2025.06.19.1] Включен LiveOnDemand`
  - `[release-2025.06.19.0] Receiver`

### Теги релиза

Используются схема тегирования:

**Современная схема**:

- `ver-2025.06.19.1`
- `ver-2025.06.19.0`

**Правило**: Используется схема `ver-YYYY.MM.DD.i`, где `YYYY.MM.DD` - дата релиза, `i` - патч-версия.

### Коммиты deploy

**Правило**: Коммиты развертывания используют префикс `[deploy]` и содержат описание изменений в деплойменте:

- `[deploy] Версия Sender`
- `[deploy] версия grpc-proxy`

### Коммиты bugfix

Багфиксы используют различные форматы названий:

**С префиксом bugfix**:

- `[bugfix AR-1322] закрывать строки pgx явно`

**Правило**: Багфиксы могут использовать префиксы `[bugfix AR-XXXX]`.
